"use client"

import { useEffect, useRef, useState } from "react"
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog"
import { Button } from "@/components/ui/button"
import { ChevronLeft, ChevronRight } from "lucide-react"
import { ScrollArea } from "@/components/ui/scroll-area"
import Link from "next/link"
import styles from '@/styles/book-reader-modal.module.css'

interface BookReaderModalProps {
  open: boolean
  onOpenChange: (open: boolean) => void
}

export function BookReaderModal({ open, onOpenChange }: BookReaderModalProps) {
  const [currentChapter, setCurrentChapter] = useState(0)
  const scrollWrapperRef = useRef<HTMLDivElement | null>(null)

  const getViewport = () =>
    scrollWrapperRef.current?.querySelector<HTMLDivElement>(
      '[data-slot="scroll-area-viewport"]'
    ) ?? null

  const chapters = [
    {
      title: "1",
      content: `השיעור הכי שנוא עליי בבית ספר הוא תנ"ך, שיעור כל־כך משעמם. זה כמו ללמוד היסטוריה, אבל על דברים שמישהו המציא, ואני גם לא בטוח שהוא היה פיכח כל הזמן הזה.
"לוקאס מילר!" צעקה גברת לוי, המורה שלי לתנ"ך. קמתי בפתאומיות. "תרצה לעשות הקדמה לכיתה לקראת השיעור של מחר על שבעת ימי הבריאה?" המשיכה ואמרה בחיוך. התחלתי למלמל הסבר כשסבסטיאן התערב, "סיפור נפלא על ההתחלה של הכל. 'בְּרֵאשִׁית בָּרָא אֱלֹהִים אֵת הַשָּׁמַיִם וְאֵת הָאָרֶץ׃ וְהָאָרֶץ הָיְתָה תֹהוּ וָבֹהוּ וְחֹשֶׁךְ עַל־פְּנֵי תְהוֹם וְרוּחַ אֱלֹהִים מְרַחֶפֶת עַל־פְּנֵי הַמָּיִם׃' בזמנו לא היה קיים דבר מלבד אלוהים, ולכן הוא החליט ליצור את העולם." סבסטיאן חייך אליי וראיתי את עיני הענבר שלו אומרות, "אני דואג לך". אני והוא חברים טובים עוד מהיום הראשון בתיכון. מאז שאני מכיר אותו תמיד הוא היה חכם ובטוח בעצמו ותמיד ידע לספק תשובות. גברת לוי התאכזבה מעט מכך שלא הצליחה להביך אותי בפני הכיתה ואמרה בנימוס, "נכון. תודה סבסטיאן, עכשיו –"
לפעמים סבסטיאן היה קצת יותר מדי בטוח בעצמו. הוא אף פעם לא ידע מתי לעצור, וגם לא הפעם. "אלוהים התחיל בליצור את המלאכים, משרתיו ועושי דברו של האל," קטע אותה והמשיך בנאום שלו, "הוא התייעץ עם יד ימינו – הלוא הוא המלאך הבכיר ביותר – על מה צריך ליצור, איפה ימוקמו הדברים ומה יהיו תפקידם. ביום הראשון הוא פקד על המלאכים ליצור אור, אז הם הציבו אש גדולה ונצחית שהאירה את הכאוס. ביום השני משכה תִיאַמַת את כל המים אליה, ובכך הפרידה בין השמיים למים." הוא נעמד והמשיך בהתלהבות בנאום שלו, "ביום השלישי משכו המלאכים מתוך המים את היבשה וזרעו בה צמחים מכל הסוגים. ביום הרביעי הם לקחו את האש ודחסו אותה לכדי כדור קטן, עד שנוצרה השמש, בזמן שהוא יצר את הירח ומיקם אותו בשמיים. את הלהבות הקטנות יותר כל מלאך דחס בכף ידו, וכך יצרו את הכוכבים. ביום החמישי הנדסו ועיצבו את החיות, מה כל אחת תאכל, איפה תגור, מה תהיה תוחלת החיים שלה... ביום השישי לקח אלוהים עפר ויצר את האדם." בסוף דבריו הוא התיישב, וגברת לוי אמרה, "תודה על הפרשנות הנרחבת, סבסטיאן. בכל מקרה –" 
הפעם קטעה אותה אמה, הילדה הכי יפה וחכמה בכיתה, בעלת עיניים כחולות בהירות ושיער זהוב ארוך שקלוע לצמה, "שטויות, סבסטיאן. מלאכים? לא כתוב שום דבר על מלאכים ובטח לא כתוב כלום על 'יד ימינו' של אלוהים." שאר התלמידים בכיתה התחילו להתלחשש ביניהם לחשושי הסכמה עם אמה. גם אני הסתכלתי על סבסטיאן במבט מבולבל. היא עצרה לשניות אחדות והוסיפה, "מה זה בכלל השם הזה שהמצאת?"
"תִיאַמַת," הוא הגה את השם באיטיות ובדיוק, "אלת הים במיתולוגיה הבבלית, היפה מכל האלים! במקרים מאוחרים יותר היא מתוארת בתור מפלצת תת־ימית שהובסה על ידי אל אחר. באמת, אמה, ציפיתי ממלכת הכיתה לדעת עובדות בסיסיות כאלה."
"אני לא יודעת מי הכריז עליי כמלכת הכיתה," היא השיבה בטון מזלזל, "אבל אני כן יודעת, כמו שכל ילד בגן יודע, שלמפלצות תת־ימיות מהמיתולוגיה הבבלית אין כל קשר לבריאת העולם בתורה." התלמידים האחרים פרצו בצחוק. סבסטיאן נעץ מבט נוקב באמה, העיניים שלו נצצו מרוב כעס והוא סינן מבין שיניו מה שאני משער שהיה קללה. גברת לוי חיכתה כמה שניות, כמו מוודאת שאף תלמיד אחר לא עומד להתפרץ לדבריה, בפעם השלישית, ואמרה, "יצירת מלאכים ושימוש בהם לבריאה היא אכן אחת הפרשנויות, וגם אחת שתוכלו להציג במבחן, אם כי היא איננה נפוצה. אני ממליצה לכם להשתמש בפרשנות הרווחת שעל פיה אלוהים יצר את הכל לבדו. בכל הנוגע למפלצות תת־ימיות, אני לא רוצה לקרוא שום דבר כזה במבחן, סבסטיאן." בשנייה שבה סיימה את המשפט נשמע הצלצול שבישר על סופו של השיעור. היא צעקה את שיעורי הבית אל חלל הכיתה, בזמן שכולנו ארזנו את הדברים בניסיון להתעלם ממנה.

מאוחר יותר באותו היום נפגשנו סבסטיאן, איתי, אדם ואני בבית של אדם.
את איתי ואדם אני מכיר מאז שאני זוכר את עצמי; איתי הוא המחושב וקר־הרוח שבחבורה, בוחן ומהרהר בהחלטות שלו דקות ארוכות לפני שמבצע אותן; ואדם הוא הפזיז שכל הזמן עושה שטויות ומותח גבולות, אבל מצליח לצאת מזה בזול עם עיני העגל החומות והגדולות שלו. ישבנו על הספה אצלו בסלון ושיחקנו במשחק יריות כשאיתי שאל כבדרך אגב, "אתם מגיעים למסיבת הבריכה של אמה בשבת?"
"מסיבת בריכה? בטח, למה לא," ענה סבסטיאן באדישות והמשיך ללחוץ על כפתורים בשלט. 
"חשבתי שאתה לא סובל את אמה," אמרתי לו בזמן שיריתי לדמות של אדם בדיוק בראש. 
אדם זרק את השלט בתסכול על הספה ואמר, "איך אפשר לשנוא מישהי כל־כך חמודה? כל־כך מתוקה? אתם יודעים שהיא מתנדבת ב'צער בעלי חיים'?" הוא התיישב על שולחן הקפה הנמוך שעליו הניח סבסטיאן את הרגליים. עצרתי את המשחק ופניתי לאדם, "היום שניהם התחילו להתווכח בשיעור תנ"ך על מפלצות ים בבליות. אם הייתה לו ההזדמנות הוא היה זורק עליה שולחן."
"וטוב שלא הייתה לי ההזדמנות, כי לגמרי הייתי עושה את זה," אמר סבסטיאן ברוגז והתיישב קרוב יותר לקצה הספה. אדם נעמד והכריז בטון אבירי, "אם רק תיגע בשערה מראשה, אקטול אותך ואת מפלצתך! בור מוג־לב!"
"אני לא מבין איך אתה מאוהב בה, היא כזאת מזויפת. אני מכיר אותה והיא לא מה שאתה חושב שהיא," אמר לאדם.
"כבר שנתיים וחצי שכל מה ששומעים ממך זה 'אמה שלי,' 'היא כזאת יפה,' 'היא כזאת מתוקה'," התערב איתי, הסיר את המשקפיים שלו והפנה אותם לכיוון אדם, "תהיה גבר פעם אחת ותזמין אותה לצאת."
סבסטיאן חייך חיוך זדוני, "בוא נעשה ככה, יש לך עד מסיבת הבריכה בשבת להשכיב אותה." 
אדם הסמיק. 
"אני אדאג להכל, אתה רק צריך להפסיק להיות נמושה ולאזור אומץ כבר," הוסיף סבסטיאן.
"סֶבּ, אתה לא חושב שזה קצת מוגזם? הילד קצת מאוהב, זה הכול," ניסיתי להרגיע את הרוחות.
"לא, לוק, איתי צודק. הוא צריך להפסיק להיות כזה רכרוכי. ושאני לא אתחיל לדבר עליך ועל יסמין, כבר ארבעה חודשים שאתם ביחד ועוד לא עשיתם כלום."
"היא ביקשה שניקח את הדברים לאט, ואני מכבד את הבקשה שלה," עניתי, נבוך. "בשבוע הבא יש לה יום הולדת והזמנתי לנו מקום במסעדה ממש יקרה... לא דיברנו על אמה בכלל?" הפניתי את השיחה בחזרה לנושא המקורי.

יסמין ואני התחלנו לצאת בתחילת החופש האחרון. אנחנו מכירים עוד מתחילת התיכון, אבל רק לפני ארבעה חודשים אזרתי מספיק אומץ כדי להזמין אותה לצאת. יש לה עיניים כחולות בהירות שאני יכול לבהות בהן שעות ושיער בלונדיני גלי וארוך שמגיע עד מותניה. יש לה קעקוע של כנפיים שמכסה את כל הגב שלה, עשרות נוצות נחות זו על זו, כל אחת מורכבת מעשרות קווים דקים; היא אומרת שהיא שאבה השראה מציורי המלאכים של תקופת הרנסנס. היא נמוכה ממני, אבל לא בהרבה, ככה שהיא בדיוק בגובה הנכון לחיבוק. והיא אוהבת חיות. והיא אוהבת ילדים. והיא אוהבת ספורט. בקיצור, אין לי דרך אחרת לתאר אותה חוץ ממושלמת.
אדם האדים אפילו יותר. איתי הרכיב את המשקפיים ואמר, "אתה באמת קצת מגזים, סבסטיאן. חוץ מזה, אני חושב שהוא רוצה להיות איתה קצת יותר מלילה."
"לא אמרתי שזה חייב להיות רק לילה אחד," הוא ענה בחיוך מרוצה, ואני זרקתי עליו את אחת מכריות הספה. אדם עמד וצעק, "הפכת את אפרודיטה שלי לשטן!" 
"היא בהחלט אפרודיטה," גיחך סבסטיאן, "ובכל זאת השטן עדיף ממנה. הוא אומנם עטה פעם צורה של נחש, אבל אין לו אישיות של אחד."
"נכון, שכחתי שאתה מאוהב בשטן," ציין אדם בגלגול עיניים והצביע על הקעקוע שעל כתפו השמאלית של סבסטיאן. בקושי שמו לב לקעקוע, הדיו הייתה דהויה מאוד והוא כמעט נטמע לגמרי בעורו הכהה; הקעקוע הורכב ממשולש הפוך שצלעותיו נמשכו אחרי נקודות המפגש והסתלסלו כלפי מעלה, כך שקצוות האות v שצוירה, נחו בין שני החלקים המסולסלים. בנוסף שני קווים נמתחו מקודקודי הבסיס והסתיימו קצת מעל הקטע המסולסל המנוגד להם. סבסטיאן קרא לסימן הזה "החותם של לוציפר".
"אני לא מאוהב בשטן, אני פשוט מאמין בו ובעבודה שלו," אמר סבסטיאן בזמן שמשך את הרגל של אדם, מפיל אותו לרצפה. איתי ואני צחקנו. סבסטיאן נעמד מעל אדם והושיט לו יד, "אולי שלושה ימים הם באמת זמן קצר מדי בשביל אדם שלנו. אני אתן לך חודשיים למשימה, בתנאי שאתה יוצא מהמסיבה עם תאריך לדייט." אדם היסס במשך שניות אחדות ולבסוף לחצו השניים ידיים.`,
    },
    {
      title: "2",
      content: `את המוזיקה יכולנו לשמוע עוד מהקצה השני של הרחוב. הבית שלה היה מרשים, וילה בעיצוב מודרני ובה שלוש קומות, מוקפת בגינה ובה היו שלל אדניות עם ירקות ועצי פרי. משמאל לשער הכניסה הגדול הייתה בריכה אולימפית, ג'קוזי לא פחות גדול היה צמוד אליה ובקצהָ הוקמה עמדת די־ג'יי עם שני רמקולים גדולים.
אדם וסבסטיאן הגיעו לפנינו, וכפי שזה נראה, לא קרה הרבה עם העסקה של שניהם, לפחות לא מצידו של אדם. הוא ישב על כיסא גבוה ובהה בכוסות ריקות שנחו לפניו, הרגל שלו קיפצה מעלה ומטה בעצבנות בעוד שסבסטיאן רקד עם כמה בנות בביקיני ליד הבריכה, מחזיק שתי כוסות שתייה גבוהות, אחת בכל יד.
איתי ואני ניגשנו לאדם, הוא היה חיוור ומזיע מכף רגל ועד ראש. ניסינו לשאול אותו אם הוא מרגיש טוב, אבל הוא לא ענה. במשך כמה דקות הוא נשאר דומם עד שהסתכל עליי ואמר בטון עגמומי, "לוק, אני חושב שאני הולך לגיהינום."
"גם אם אלוהים קיים," צחקתי, "איזו סיבה יש לו לשלוח אותך לגיהינום?"
עיני העגל של אדם התרחבו, "מה זאת אומרת?" שאל בתמימות, "שתיתי. ואני עוד לא בן שמונה־עשרה! אני בטוח הולך לגיהינום."
איתי הניח את ידו על הגב של אדם והוסיף בדאגה, "כמה כוסות כבר שתית?" אבל אדם התעלם מהשאלה, המבט שלו נהפך קר ומתוסכל. "זה לא משנה בכלל, תסתכל עליה!" הוא הצביע בתנועות ידיים רחבות לכיוון אמה, "אני לא מסוגל לעשות כלום. היא כל הזמן ליד אהרון, אני חושב שהם יוצאים!"
אהרון הוא אחד הספורטאים הטובים בבית הספר וחבר טוב של אמה, כל הבנות בשכבה מאוהבות בו בגלל העיניים הכחולות, השיער הבלונדיני והכתפיים הרחבות שלו. "תאמין לי, אלוהים קיים וממש לא אכפת לו מגיל השתייה החוקי," אמר קול רך מאחורינו. זאת הייתה יסמין, היא לבשה בגד ים פרחוני שפתוח בחלקו האחורי והציג בגאווה רבה את הקעקוע שלה. "לאלוהים לא אכפת מחוקים שבני אדם המציאו. כל עוד לא עברת על עשרת הדיברות, אתה תהיה בסדר," היא הוסיפה ומזגה לעצמה כוס משקה.
"נכון, את צודקת, אין לי ממה לפחד!" הוא נעמד בחיוך של תקווה מחודשת, שנמחק באותה המהירות. "אני לא יכול לעשות את זה..." הוא מלמל ורוקן עוד כוס שלמה. יסמין הסתכלה עליו במבט מבולבל. "עוד אחת מההתערבויות של סבסטיאן," אמר לה איתי.
"אם זה לגבי אמה, אל תדאג, היא ואהרון לא ביחד," היא לחשה (או לפחות ניסתה ללחוש) באוזנו של אדם.

יסמין ואני ישבנו על אחת מכורסאות הבד שבחצר, שהשקיפו אל הבריכה. ישבנו מחובקים כשהיד שלי מונחת על הכתף שלה. היא הניחה את ראשה על הכתף שלי, מאפשרת לי להריח את ריח הלבנדר העדין שעלה משיערה.
"לא ידעתי שאת מאמינה באלוהים," אמרתי אחרי שתיקה ארוכה. 
"לא כולם מאמינים?" היא הגיבה בקול תמים.
"לא, לא כולם מאמינים. את גם לא כל־כך מתנהגת כמו אחת כזאת שמאמינה, אז פשוט הסקתי..."
"אני חושבת שכולם מאמינים באלוהים, גם אתה. אולי לא באותה צורה, אבל לכולם יש אמונה. חלק מהאנשים בוחרים להתכחש לתחושה הזאת, אבל זה לא אומר שזה לא נכון. בטח ובטח לא אם מדובר ביוצר של כל היקום!
"הבעיה שלך היא שאתה מקובע בדעות שאחרים קבעו לפניך. אין דפוס התנהגות לאדם שמאמין. אלוהים הוא טוב, הוא נתן הנחיות לאנשים בימי קדם, אבל הם פירשו אותן לא נכון ועכשיו כולם סובלים מזה, ולמרות זאת הוא עדיין שולח מלאכים לעזור לאנושות, והוא עדיין מחולל ניסים."
"אני לא מאמין בניסים," אמרתי כאילו מתוך אינסטינקט, "לכל דבר יש הסבר מדעי. האנשים של ימי קדם לא ידעו להסביר תופעות, אז הם המציאו אלים וסיבות שבגללן האלים האלו כועסים עליהם. הקציר לא טוב השנה? האלים כועסים. השמש נעלמה? האלים כועסים. אדם חשוב מת? האלים כועסים.
"לכל דבר טוב שאין לו הסבר קראו נס. זה היה נוח להמציא ניסים ולייחס אותם לדמויות דמיוניות, אבל היום אנחנו חכמים יותר ואנחנו יודעים לתת הסברים לכל דבר. אנחנו יודעים שהשמש לא נעלמת כי דרקון ענקי אכל אותה, אלא כי הירח רק מסתיר אותה, ואנחנו גם יודעים לחזות מתי זה יקרה."
"יש הרבה דברים שהמדע לא יודע להסביר, וכנראה גם הרבה דברים שהוא לעולם לא יוכל להסביר. רק בגלל שאלוהים הפסיק לתקשר ישירות עם בני האדם הם החליטו שהוא לא קיים, אבל לא כך זה עובד. אם אתה עוצם עיניים, העולם לא מפסיק להתקיים רק בגלל שאתה לא רואה אותו."
"הרבה יותר קל לי להאמין שכמה אנשים שתו יותר מדי יין מקולקל, מאשר שנגלה לעיניהם יוצר־היקום־הכול־יכול־וכל־נמצא־חסר־הגוף. גם אם הוא קיים, והוא לא," הרגשתי צורך להדגיש, "אני לא מוכן להאמין באל שנוטש את היצירות שלו ומצפה שימשיכו להאמין בו."
היא התיישבה כך שכל הגוף שלה פונה אליי (נראה לי שעצבנתי אותה), "אָנֹכִי יְהוָה אֱלֹהֶיךָ, זה הדיבר הראשון ולדעתי גם החשוב ביותר. האמונה באלוהים." היא עצרה למשך שניות אחדות, כאילו מחכה שאגיב. "בקצב הזה אולי אתה תהיה זה שילך לגיהינום."
"אם אני אוכל להיות איתך לנצח, גם אם השטן יענה אותי לא יהיה לי אכפת," אמרתי ונישקתי אותה על הצוואר. לא רציתי להמשיך את השיחה הזאת. היא גלגלה עיניים ומשכה אותי מהכורסה לכיוון הבריכה. לפתע שמענו את אריאל צועקת על אדם.

אריאל ישבה על כיסא גבוה ליד שולחן עגול וקטן, המבט שלה היה מושפל מטה ואדם ישב צמוד אליה. נראה שמאוד לא נוח לה עם הקירבה המוגזמת של אדם. ניגשתי אליו ומשכתי אותו הצידה. "מה אתה עושה?" היה הדבר היחיד שיכולתי לחשוב עליו באותו רגע. 
"אל תדאג, הכול תחת שליטה, זה בכיס הקטן שלי, יהיה בסדר, אני אצליח," הוא מלמל, וריח חריף של אלכוהול עלה מהבל הפה שלו. המוזיקה לא פסקה, אבל כמעט כולם הסתכלו עכשיו לכיווננו.
"על מה אתה מדבר? זה קשור להתערבות המפגרת שלך ושל סבסטיאן?"
"כן כן כן, תקשיב, הבנאדם גאון, דיברתי איתו, הוא הסביר לי בדיוק מה אני צריך לעשות. להתחיל עם אריאל." היה לו חיוך תמים והוא הצביע בשתי הידיים על סבסטיאן, שישב על שפת הבריכה הנגדית והיה עסוק בלבדוק כמה עמוק הלשון שלו מגיעה אל תוך הגרון של אחת הבנות שרקד איתן קודם לכן, רק שהפעם הרגליים והידיים שלה היו כרוכות סביבו.
התקרבתי לאדם ושאלתי בטון חלש, "אתה יודע שהיא לסבית, נכון?"
"בדיוק!" העיניים שלו נצצו כאילו הגה תאוריה שתשנה את העולם, "אם אני מצליח להשיג דייט איתה, אני אצליח עם כל אחת, זה גאוני!" 
רוב האנשים חזרו לרקוד, לשחות ולפטפט ביניהם. יסמין התקרבה אלינו ושאלה אם היא יכולה לעזור במשהו.
אדם ניצל את חוסר תשומת הלב שלי וחזר לניסיונות הכושלים שלו להתחיל עם אריאל. מיהרתי אליו. כואב לי אפילו לתאר את כל הדברים שהוא ניסה ואת התשובות שהצלחתי לשמוע בזמן הקצר הזה מצידה.
אריאל נעמדה, עיניה הכחולות שמרכזן חום, שמזכירות רצועת חוף המקיפה אי בודד, נמלאו כעס. "אתה אדם מגעיל. אני לא מעוניינת לצאת איתך! אני אף פעם לא אהיה מעוניינת לצאת איתך! הלוואי שתירקב בגיהינום!" היא צעקה עליו והטיחה את תכולת הכוס שלה לכיוונו.
למזלו של אדם, יש לו אינסטינקטים מעולים. הוא הצליח להתכופף בדיוק בזמן כדי להתחמק מאותו איום נוזלי. לרוע מזלי, אני עמדתי בדיוק מאחוריו. במקום הלא נכון, בזמן הלא נכון.
גל של וודקה צרב את הפנים שלי. לא יכולתי לראות דבר. מעדתי לאחור ומצאתי את עצמי רטוב יותר מכפי שהייתי שנייה לפני כן. נפלתי לתוך הבריכה.
הדבר האחרון שאני זוכר לפני שאיבדתי את ההכרה הוא את קולו המעומעם של סבסטיאן, ואחריו קול חזק של פגיעה במים.`,
    },
  ]

  function handleChapterChange(inc: number) {
    setCurrentChapter((curr) => curr + inc)

    const viewport = getViewport()
    setTimeout(() => viewport?.scroll({ top: 0, behavior: "smooth" }), 10)
    setTimeout(() => viewport?.focus(), 20) // keep keyboard scrolling after chapter change
  }

  const currentPageData = chapters[currentChapter]

  return (
    <Dialog open={open} onOpenChange={(open) => { onOpenChange(open); setCurrentChapter(0) }}>
      <DialogContent
        className="max-w-4xl max-h-[90vh] p-0"
        onOpenAutoFocus={(e) => {
          e.preventDefault() // prevent Dialog from focusing the first focusable element
          const viewport = getViewport()
          if (!viewport) return
          viewport.tabIndex = 0
          viewport.focus()
        }}
      >
        <DialogHeader className="p-6 pb-0">
          <DialogTitle className="text-2xl text-center">{currentPageData.title}</DialogTitle>
        </DialogHeader>

        <div ref={scrollWrapperRef}>
          <ScrollArea className="h-[60vh] px-6">
            <div className="space-y-6 py-4">
              <div className={`flex justify-center ${styles.invert}`}>
                <img
                  src="/Images/chapter_divider.webp"
                  alt="איור פרק"
                  className="rounded-lg max-w-full h-auto"
                />
              </div>

              <div className="prose prose-lg dark:prose-invert max-w-none text-right leading-relaxed">
                <div className={`whitespace-pre-line text-lg leading-loose ${styles.rtl} ${styles.fontFR}`}>
                  {currentPageData.content}
                </div>
              </div>

              <div className="border-t pt-6 text-center" hidden={currentChapter < chapters.length - 1}>
                <p className="text-muted-foreground mb-4">רוצים לקרוא עוד?</p>
                <Button asChild>
                  <Link href="/store" onClick={() => onOpenChange(false)}>
                    לרכישת הספר המלא
                  </Link>
                </Button>
              </div>
            </div>
          </ScrollArea>
        </div>

        <div className="flex items-center justify-between p-6 border-t">
          <Button
            variant="outline"
            size="icon"
            disabled={currentChapter <= 0}
            aria-label="פרק קודם"
            onClick={() => handleChapterChange(-1)}
          >
            <ChevronRight className="h-4 w-4" />
          </Button>

          <span className="text-sm text-muted-foreground">
            פרק {currentChapter + 1} מתוך {chapters.length} זמינים
          </span>

          <Button
            variant="outline"
            size="icon"
            disabled={currentChapter >= chapters.length - 1}
            aria-label="פרק הבא"
            onClick={() => handleChapterChange(1)}
          >
            <ChevronLeft className="h-4 w-4" />
          </Button>
        </div>
      </DialogContent>
    </Dialog>
  )
}